['FUNCTION FUN_LinearInterpolation : REAL\nVAR_INPUT\n    rX1 : REAL;    // 第一个点的X坐标\n    rY1 : REAL;    // 第一个点的Y坐标\n    rX2 : REAL;    // 第二个点的X坐标\n    rY2 : REAL;    // 第二个点的Y坐标\n    rCurrentX : REAL; // 当前X值\nEND_VAR\n\nVAR\n    rSlope : REAL; // 斜率\n    rIntercept : REAL; // 截距\nEND_VAR\n\n// 计算斜率和截距\nrSlope := (rY2 - rY1) / (rX2 - rX1);\nrIntercept := rY1 - (rSlope * rX1);\n\n// 计算并返回插值结果\nFUN_LinearInterpolation := (rSlope * rCurrentX) + rIntercept;\nEND_FUNCTION', 'TYPE DUT_CAMTABLE :\nSTRUCT\n    // 10个点的XY坐标数组\n    aPointsX : ARRAY[1..10] OF REAL;\n    aPointsY : ARRAY[1..10] OF REAL;\n    \n    // 8个缩放参数\n    rScaleParam1 : REAL;\n    rScaleParam2 : REAL;\n    rScaleParam3 : REAL;\n    rScaleParam4 : REAL;\n    rScaleParam5 : REAL;\n    rScaleParam6 : REAL;\n    rScaleParam7 : REAL;\n    rScaleParam8 : REAL;\n    \n    // 编辑器范围参数\n    rEditorMinX : REAL;\n    rEditorMaxX : REAL;\n    rEditorMinY : REAL;\n    rEditorMaxY : REAL;\n    \n    // 实际表格范围参数\n    rTableMinX : REAL;\n    rTableMaxX : REAL;\n    rTableMinY : REAL;\n    rTableMaxY : REAL;\nEND_STRUCT\nEND_TYPE\n\nFUNCTION FUN_RangeMapping : REAL\nVAR_INPUT\n    rInputValue : REAL;         // 原始值\n    rSrcMin : REAL;             // 原始范围最小值\n    rSrcMax : REAL;             // 原始范围最大值\n    rDestMin : REAL;            // 目标范围最小值\n    rDestMax : REAL;            // 目标范围最大值\nEND_VAR\n\nVAR\n    rNormalized : REAL;         //  归一化值\n    rOutputValue : REAL;        // 输出值\nEND_VAR\n\n// 实现线性范围映射\nIF (rSrcMax <> rSrcMin) THEN\n    // 归一化到[0,1]范围\n    rNormalized := (rInputValue - rSrcMin) / (rSrcMax - rSrcMin);\n    \n    // 映射到目标范围\n    rOutputValue := rDestMin + rNormalized * (rDestMax - rDestMin);\nELSE\n    // 防止除以零，返回目标范围中点\n    rOutputValue := (rDestMin + rDestMax) / 2.0;\nEND_IF\n\nFUN_RangeMapping := rOutputValue;\nEND_FUNCTION', 'TYPE DUT_CAMTABLE :\nSTRUCT\n    // 10个点的XY坐标数组\n    aPointsX : ARRAY[1..10] OF REAL;\n    aPointsY : ARRAY[1..10] OF REAL;\n    \n    // 8个缩放参数\n    rScaleParam1 : REAL;\n    rScaleParam2 : REAL;\n    rScaleParam3 : REAL;\n    rScaleParam4 : REAL;\n    rScaleParam5 : REAL;\n    rScaleParam6 : REAL;\n    rScaleParam7 : REAL;\n    rScaleParam8 : REAL;\n    \n    // 编辑器范围参数\n    rEditorMinX : REAL;\n    rEditorMaxX : REAL;\n    rEditorMinY : REAL;\n    rEditorMaxY : REAL;\n    \n    // 实际表格范围参数\n    rTableMinX : REAL;\n    rTableMaxX : REAL;\n    rTableMinY : REAL;\n    rTableMaxY : REAL;\nEND_STRUCT\nEND_TYPE\n\nFUNCTION_BLOCK FB_CamTableProcessor\nVAR_INPUT\n    // 输入值\n    rInputValue : REAL;\n    // 凸轮表数据\n    stCamTable : DUT_CAMTABLE;\n    // 初始化请求\n    bInit : BOOL;\nEND_VAR\n\nVAR_OUTPUT\n    // 计算结果\n    rOutputValue : REAL;\n    // 错误代码\n    iErrorCode : INT;\n    // 数据校验结果\n    bDataValid : BOOL;\nEND_VAR\n\nVAR\n    // 当前激活的凸轮表索引\n    iActiveTableIndex : INT;\n    // 上 次计算结果\n    rLastOutputValue : REAL;\n    // 初始化完成标志\n    bInitialized : BOOL;\nEND_VAR\n\nMETHOD PRIVATE ValidateCamTableData : BOOL\nVAR_INPUT\n    stTable : DUT_CAMTABLE;\nEND_VAR\nVAR\n    i : INT;\n    bValid : BOOL := TRUE;\nEND_VAR\n\n// 检查X坐标是否单调递增\nFOR i := 1 TO 9 DO\n    IF stTable.aPointsX[i] >= stTable.aPointsX[i+1] THEN\n        bValid := FALSE;\n        EXIT;\n    END_IF\nEND_FOR\n\n// 检查编辑器范围是否有效\nIF (stTable.rEditorMinX >= stTable.rEditorMaxX) OR \n   (stTable.rEditorMinY >= stTable.rEditorMaxY) THEN\n    bValid := FALSE;\nEND_IF\n\n// 检查实际表格范围是否有效\nIF (stTable.rTableMinX >= stTable.rTableMaxX) OR \n   (stTable.rTableMinY >= stTable.rTableMaxY) THEN\n    bValid := FALSE;\nEND_IF\n\nValidateCamTableData := bValid;\nEND_METHOD\n\nMETHOD PRIVATE ScaleInputValue : REAL\nVAR_INPUT\n    rValue : REAL;\n    stTable : DUT_CAMTABLE;\nEND_VAR\nVAR\n    rScaledValue : REAL;\nEND_VAR\n\n// 将输入值从实际表格范围缩放到编辑器范围\nrScaledValue := (rValue - stTable.rTableMinX) * \n                (stTable.rEditorMaxX - stTable.rEditorMinX) / \n                (stTable.rTableMaxX - stTable.rTableMinX) + \n                stTable.rEditorMinX;\n\nScaleInputValue := rScaledValue;\nEND_METHOD\n\nMETHOD PRIVATE ScaleOutputValue : REAL\nVAR_INPUT\n    rValue : REAL;\n    stTable : DUT_CAMTABLE;\nEND_VAR\nVAR\n    rScaledValue : REAL;\nEND_VAR\n\n// 将输出值从编辑器范围缩放到实际表格范围\nrScaledValue := (rValue - stTable.rEditorMinY) * \n                (stTable.rTableMaxY - stTable.rTableMinY) / \n                (stTable.rEditorMaxY - stTable.rEditorMinY) + \n                stTable.rTableMinY;\n\nScaleOutputValue := rScaledValue;\nEND_METHOD\n\nMETHOD PRIVATE InterpolateValue : REAL\nVAR_INPUT\n    rInput : REAL;\n    stTable : DUT_CAMTABLE;\nEND_VAR\nVAR\n    i : INT;\n    rX1, rX2, rY1, rY2 : REAL;\n    rResult : REAL;\nEND_VAR\n\n// 查找输入值所在的区间\nFOR i := 1 TO 9 DO\n    IF (rInput >= stTable.aPointsX[i]) AND (rInput <= stTable.aPointsX[i+1]) THEN\n        rX1 := stTable.aPointsX[i];\n        rX2 := stTable.aPointsX[i+1];\n        rY1 := stTable.aPointsY[i];\n        rY2 := stTable.aPointsY[i+1];\n        \n        // 线性插值计算\n        rResult := rY1 + (rInput - rX1) * (rY2 - rY1) / (rX2 - rX1);\n        EXIT;\n    END_IF\nEND_FOR\n\n// 处理超出范围的情况\nIF rInput < stTable.aPointsX[1] THEN\n    rResult := stTable.aPointsY[1];\nELSIF rInput > stTable.aPointsX[10] THEN\n    rResult := stTable.aPointsY[10];\nEND_IF\n\nInterpolateValue := rResult;\nEND_METHOD\n\n// 主程序\nIF bInit THEN\n    // 初始化处理\n    bDataValid := ValidateCamTableData(stCamTable);\n    IF bDataValid THEN\n        bInitialized := TRUE;\n        iErrorCode := 0;\n    ELSE\n        bInitialized := FALSE;\n        iErrorCode := 1; // 数据无效错 误\n    END_IF\nEND_IF\n\nIF bInitialized THEN\n    // 处理输入值\n    rOutputValue := ScaleOutputValue(\n        InterpolateValue(\n            ScaleInputValue(rInputValue, stCamTable),\n            stCamTable\n        ),\n        stCamTable\n    );\n    rLastOutputValue := rOutputValue;\nELSE\n    // 未初始化时输出0\n    rOutputValue := 0;\n    iErrorCode := 2; // 未初始化错误\nEND_IF\nEND_FUNCTION_BLOCK', 'TYPE DUT_CAMTABLE :\nSTRUCT\n    // 10个点的XY坐标数组\n    aPointsX : ARRAY[1..10] OF REAL;\n    aPointsY : ARRAY[1..10] OF REAL;\n    \n    // 8个缩放参数\n    rScaleParam1 : REAL;\n    rScaleParam2 : REAL;\n    rScaleParam3 : REAL;\n    rScaleParam4 : REAL;\n    rScaleParam5 : REAL;\n    rScaleParam6 : REAL;\n    rScaleParam7 : REAL;\n    rScaleParam8 : REAL;\n    \n    // 编辑器范围参数\n    rEditorMinX : REAL;\n    rEditorMaxX : REAL;\n    rEditorMinY : REAL;\n    rEditorMaxY : REAL;\n    \n    // 实际表格范围参数\n    rTableMinX : REAL;\n    rTableMaxX : REAL;\n    rTableMinY : REAL;\n    rTableMaxY : REAL;\n    \n    // 编辑历史记录（最多保存10次历史记录）\n    aHistory : ARRAY[0..9] OF DUT_CAMTABLE;\n    nHistoryIndex : INT;  // 当前历史记录索引\n    nHistoryCount : INT;  // 有效历史记录数量\n    \n    // 当前选中的点索引（0表示未选中）\n    nSelectedPoint : INT;\nEND_STRUCT\nEND_TYPE']